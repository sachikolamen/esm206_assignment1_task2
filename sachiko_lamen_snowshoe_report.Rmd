---
title: "Snowshoe Report"
author: "Sachiko Lamen"
date: "11/4/2021"
output: 
  html_document: 
    theme: cerulean
    highlight: pygments
    toc: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
library(tidyverse)
library(here)
library(janitor)
library(equatiomatic)
library(lubridate)
library(kableExtra)
library(effsize)
library(plotly)
library(broom)
```
## **Introduction:** Add introduction A 4 - 5 sentence "mini-introduction" to what this study is exploring, including basic background information about the subject, site and study (with citations as needed), and a brief overview of what is included in the exploratory report. You should probably do this last so you know whatâ€™s contained in the report.

## **Data and Analysis** Include data analysis A 3 - 4 sentence section in which you briefly describe the data, including citation & credit as needed, and provide an overview of the main analysis, statistical methods and tools used.

This report visualizes and wrangles data for juvenile Snowshoe Hares recorded from 1999 - 2012. Data was gathered from Bonanza Creek LTER as part of the US Long Term Ecological Research Network.

**Citation:** Kielland, K., F.S. Chapin, R.W. Ruess, and Bonanza Creek LTER. 2017. Snowshoe hare physical data in Bonanza Creek Experimental Forest: 1999-Present ver 22. Environmental Data Initiative. https://doi.org/10.6073/pasta/03dce4856d79b91557d8e6ce2cbcdc14

```{r}
bonanza <- read_csv(here("data", "bonanza_hares.csv"))
```

### Juvenile Hare Investigation
Create new data set that counts total number of juvenile hare trappings per year, then plot using `geom_line()` to visualize fluctuations in juvenile hare trappings per year from 1998 - 2012. 
```{r}
bonanza_year <- bonanza %>% # create new data set 
  mutate(date_new = mdy(date)) %>% 
  mutate(year = year(date_new)) %>% # with date converted to class "Date"
  filter(age == "j") %>% # only pull results where age = "j" (juvenile)
  select(year) %>% # select column `year`
  count(year) # counting total number of trappings per year

```

```{r}
bonanza_year_interactive <- ggplot(data = bonanza_year, aes(x = year)) +
  geom_line(aes(x = year, y = n)) +
  labs (x = "Year",
        y = "Number of Trappings",
        title = "Juvenile Hares Trapped Per Year (1999 - 2012)") +
  theme(panel.border = element_blank(),
          panel.grid.minor = element_blank(),
        panel.background = element_rect(fill = "lightblue"))

ggplotly(bonanza_year_interactive)
```
**Figure 1. Total juvenile snowshoe hares trapped in Bonanza Creek LTER (1998 - 2012)** Trapping data was compiled from three sample sites of varying environment. Line shows the total number of juvenile hares trapped each year.

```{r, include = FALSE}
stats_bonanza <- bonanza_year %>%
  group_by(year) %>%
  summarize(total_trappings = sum(n))

stats_bonanza %>%
  summarize(mean = mean(total_trappings),
            median = median(total_trappings),
            std_deviation = sd(total_trappings),
            maximum = max(total_trappings),
            minimum = min(total_trappings),
            sample_size = n())

```

Across all three sites, there is a visible decline in number of juvenile hares trapped between 1998 and 2012. Maximum number of hares trapped in a single year was `r max(stats_bonanza$total_trappings)`. Minimum number of hares trapped in a single year was `r min(stats_bonanza$total_trappings)`. Between 1998 and 2012 the mean and median number of juvenile hares trapped was `r mean(stats_bonanza$total_trappings)`, and `r median(stats_bonanza$total_trappings)`, respectively. To account for the fact that these counts are impacted by effort (e.g. number of days and traps in the study each year) you could standardize the population for future analyses by...???


## Visualize juvenile hare weights

```{r}
juveniles <- bonanza %>%
  filter(age %in% "j") %>%
           select(weight, sex, age, grid) %>%
  mutate(sex = case_when(sex == "m" ~ "Male",
                          sex == "f" ~ "Female"),
         grid = case_when(grid == "bonrip" ~ "Bonanza Riparian",
                          grid == "bonmat" ~ "Bonanza Mature",
                          grid == "bonbs" ~ "Lowland Black Spruce"))


ggplot(data = juveniles, aes(x = sex, y = weight)) +
  geom_jitter(aes(color = sex), width = 0.5, size = 0.6) +
  facet_wrap(~ grid) +
  labs(title = "Juvenile Hare Weight Distribution Across Sites",
       y = "Weight (g)") +
  theme(axis.title.x = element_blank())
```
**Figure 2. Juvenile snowshoe hare weight distribution at three sites (1999 - 2012)** Each dot represents an individually observed hare, colors delineate sex (red = female, blue = male, grey = NA).

```{r}
ggplot(data = juveniles, aes(x = weight)) +
  geom_histogram(aes(fill = sex),
                color = "black",
                 bins = 30) +
  facet_grid(sex ~ grid)
```
**Figure 3. Juvenile snowshoe hare weight distribution faceted by sex and grid location** Bars represent number of hares trapped at generalized weight (bins = 30). Colors represent hare sex (red = female, blue = male, grey = NA).

Figure 1 and Figure 2 show the highest density of female and male juvenile snowshoe hares are found in the Bonanza Riparian site. The histograms in Figure 2 indicate that the data may not be normally distributed for any of the female or male populations sampled at any of the three sites. In particular, the distribution of male hares in the Bonanza Riparian site could be bimodal. 

## Juvenile weight comparison (male & female snowshoe hares)
Finalized table containing the mean, median, standard deviation, and sample size w/ table caption placed ABOVE the table 

```{r}

juveniles_stats <- juveniles %>%
  group_by(sex) %>%
  summarize(sample_size= n(),
            mean = round(mean(weight, na.rm = TRUE),2),
            median = round(median(weight, na.rm = TRUE),2),
            std_deviation = round(sd(weight, na.rm = TRUE),2),
            maximum = max(weight, na.rm = TRUE),
            minimum = min(weight, na.rm = TRUE))

juveniles_stats %>%
  kable(col.names = c("Sex",
                      "Sample Size",
                      "Mean Size (g)",
                      "Median Size (g)",
                      "Standard Deviation",
                      "Maximum Size (g)",
                      "Minimum Size (g)"),
        caption = " **Table 1. Male v. female statistics juvenile snowshoe hares (Bonanza Creek LTER.** Data was collected across three sites: Bonanza Riparian, Bonanza Mature, and Lowland Black Spruce. ") %>%
  kable_styling(full_width = FALSE)

```
```{r}
ggplot(data = juveniles, aes(x = weight)) +
  geom_histogram(bins = 15) +
  facet_wrap(~ sex)

ggplot(data = juveniles, aes(sample = weight)) +
  geom_qq() +
  facet_wrap(~sex)
```

```{r}
juvenile_females <- juveniles %>% 
  filter(sex == "Female") %>% 
  pull(weight)

juvenile_males <- juveniles %>%
  filter(sex == "Male") %>%
  pull(weight)

juvenile_t <- t.test(juvenile_females, juvenile_males, na.rm = TRUE)

juvenile_t

juvenile_cohen<- cohen.d(juvenile_females, juvenile_males, na.rm = TRUE)

juvenile_cohen
```

Actual difference between average female and male weight: `r juveniles_stats$mean[1] - juveniles_stats$mean[2]`. Cohen's d effect size: `r juvenile_cohen$magnitude`. Estimated difference in means (t-test) `r round(juvenile_t$estimate, 3)`. t(df) = `r round(juvenile_t$statistic, 3)`, p = `r round(juvenile_t$p.value, 3)`

2-3 sentence comprehensive statement of the means comparison including: actual difference, effect size (cohen's d), and outcome of an unpaired two sample t test



## Relationship between juvenile weight and hind foot length

```{r}
foot_weight <- bonanza %>%
  filter(age == "j") %>%
  select(age, hindft, weight)

ggplot(data = foot_weight, aes(x = weight, y = hindft)) +
  geom_point() +
  labs(title = "Hind Foot Length and Weight Comparison",
       x = "Weight (g)",
       y = "Hind Foot (mm)")
```
## FIGURE CAPTION

## Simple Linear Regression
```{r}
foot_weight_lm <- lm(hindft~ weight, data = foot_weight)

summary(foot_weight_lm)

foot_weight_lm_tidy <- broom::tidy(foot_weight_lm)

foot_weight_lm_tidy
```
"Simple linear regression was used to explore the relationship between snowshoe hare weight (g) and hind foot length (mm) including both male and female hares. A significant regression model was found ($\beta$ = `r foot_weight_lm$df.residual`)











Sara Guitinan Bureau of Ocean Energy Management (BOEM): Fish species distributions are changing -- BOEM -- Morro Bay offshore wind planning area -- fishing industry needs to adapt to change in species distribution -- docks, onshore processing places-- what are the needs of the fishing industry -- support for filling the needs would be mitigation of the negative impacts of an offshore wind project
What would a osw project look like if it was centered around EJ
Something on green hydrogen? -- offshore winds could potentially be used to produce hydrogen -- electrolysis. Unknowns?

Near Diablo Canyon Nuclear site that will be decomissioned soon. Conflict of negotiations between DOD and someone else. Also important to inigenous people in the area. 

Involved in 4 GP
2019 - lifecycle assessment of greenhouse gas emmisions from floating offshore winds in CA
 - report is helping to inform offshore renewable energy
Marine mammal monitoring
Citizen science for LT rocky intertidal monitoring
Ocean Acidification -- monitoring gaps and hotspots

West Coast Ocean Alliance